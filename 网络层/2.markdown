# IP数据报

- 主机发送IP数据报
- 路由器转发数据报

同一个网络下的主机可以直接通讯：直接交付
不同网络下的主机需要路由器：间接交付

![image.png](../assets/ipdate.png)

- **默认网关**：路由器接口的IP地址
- **默认路由**：是路由表中的一条规则，它告诉设备当没有找到直接的路由时，应该将数据包发送到哪里。

如果数据由C -> F，首先将IP数据报发送到本网络的路由器的IP接口（默认网关），路由器会检查IP数据报是否出错，（假设没有出错。IP数据报首部中的地址：源地址和目的地址的IP都正确），然后查找路由表，将目的地址与路由条目中的地址掩码相与，得到目的网络地址，如果与路由条目中的网络地址不匹配，则检查下一条目

![image.png](../assets/route.png)

![image.png](../assets/target.png)

# 静态路由配置和可能的路由环路问题

静态路由：人工配置的路由表

![image.png](../assets/circular.png)


# NAT

NAT是一种网络地址转换技术，主要用于解决IPv4地址不足的问题。它允许一个整个网络的设备共享一个或少数几个公网IP地址来访问互联网。

**主要特点：**

- **地址共享**：多个设备可以共享一个公网IP地址。
- **地址转换**：NAT设备（通常是路由器）在数据包进出时转换源或目的IP地址。
- **简化网络管理**：减少了管理大量公网IP地址的需求。
- **安全性**：由于NAT隐藏了内部网络的IP地址，它为网络提供了一定程度的保护，防止外部直接访问内部设备

因为网络应用是使用TCP/UDP传送数据，因此可以通过利用运输层的端口号和IP地址一起进行转换。这样多个本地主机就可以同时和外网进行通信（叫做NAPT Network Address and Port Translation）
