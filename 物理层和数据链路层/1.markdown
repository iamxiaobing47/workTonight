## 物理层的基本概念：

* 物理层解决的问题是在各种计算机的传输媒体上传输数据比特流（1 / 0）
* 物理层为数据链路层屏蔽了各种传输媒体的差异，使数据链路层只需要考虑如何完成本层的协议和服务，而不必考虑具体的传输媒体上什么

传输媒体：电缆、光纤、无线电波

# 数据链路层

![image.png](../assets/image.png)

链路（Link）是从一个节点到相邻节点的一段物理线路，而中间没有任何其他的交换节点

数据链路（Data Link）是指把实现通信协议的硬件和软件加到链路上，就构成了数据链路

数据链路层以帧为单位传输和处理数据

三个核心问题：

* 封装成帧
* 差错检测
* 可靠传输

## 封装成帧

封装成帧：数据链路层将上层交付的协议数据单元添加帧头帧尾使之成为帧

- 帧头和帧尾中包含有重要的控制信息
- 帧头和帧尾的作用之一就是**帧定界**

透明传输：数据链路层对上层交付的传输数据没有任何限制，但为了防止传输数据与帧相同，会对数据进行处理

- 面向字节的物理链路使用字节填充（字符填充）的方式实现透明传输
  - 先扫描数据，如果数据包含帧，则添加转义字符
- 面向比特的物理链路使用比特填充的方式实现透明传输

每一种数据链路层协议都规定了帧的数据部分的长度上限： 最大传送单元MTC （Maximum Transfer Unit）

# MAC地址，IP地址和ARP协议

**MAC地址**

- 当多个主机连接在同一个广播信道上，要想实现两个主机之间的通信，每个主机都必须有一个唯一的标识码，即一个数据链路层的地址
- 每个主机发送的帧中必须携带标识发送主机和接收主机的地址，叫做MAC地址
- MAC地址一般固化在网卡（网络适配器）上，所以又叫硬件地址/物理地址
- 一般情况下，主机有两个网络适配器：有线网卡和无线网卡。每个网卡有一个全球唯一的MAC地址，而交换机和路由器往往有更多的网络接口，所以有更多的MAC地址。严格来说，MAC地址是对网路上各接口的唯一标识！

**IP地址**

- IP地址是互联网上的主机和路由器所使用的地址，用于标识两部分信息：
  - 网络编号
  - 主机编号（同一网络上的不同主机或路由器各接口）

数据包转发过程中源IP地址和目的IP地址保持不变

数据包转发过程中源MAC地址和目的MAC地址逐个链路（网络）改变

**ARP协议**

- A主机向同一网络的B主机发送数据，但不知道B主机的MAC地址，就会查找主机的ARP高速缓存表，查找IP地址和MAC地址的对应关系。如果找到了，就封装MAC帧进行发送；如果没找到，则发生ARP请求（封装在广播MAC帧中，每一台主机都会收到广播）
- 目的主机收到ARP请求后，将源主机的IP和MAC记在自己的ARP高速缓存表中，然后给源主机发送ARP响应（封装在单播MAC帧中），ARP响应中包含有目的主机的IP地址和MAC地址

ARP的作用范围：**一段链路**


# VLAN



* **交换机**：负责连接多个主机，使它们能够在同一局域网内通信。交换机使用MAC地址来确定数据帧的目的地，并在主机之间转发数据

  * 交换机工作在数据链路层（也包括物理层），它收到帧后，在内部的帧交换表中查找帧的目的MAC地址与对应的接口号，然后通过该接口转发帧
  * 交换机有多个接口，每个接口都可以与一台主机或者交换机相连
  * 多个交换机可以隔离碰撞域，但不能隔离广播域。庞大的广播域会形成广播风暴。虽然路由器默认丢弃广播信息，但路由器成本太高，于是有了VLAN

- **VLAN**：（Virtual Local Area Network）是一种将局域网内的设备划分成与物理位置无关的逻辑组的技术，这些逻辑组有某些共同的需求。它是靠交换机实现的
  - 交换机必须能够处理有VLAN标识的帧
  - 借口Access, Trunk, Hybrid
